%% calculate linear regression factors to produce the total score of the PROMISE12 test set
% metrics and scores come from this random segmentation method: 
% https://promise12.grand-challenge.org/evaluation/results/cc9e8eac-de7c-4d5d-a28b-d935260e26a9/

%% clean up
clear all;
close all;

%% metrics
metrics.apex_dice= [
    0.9628914499487118,
    0.8707286949361878,
    0.9433839881393625,
    0.9310890705262818,
    0.9096751474601638,
    0.9267329383806941,
    0.8457339844872163,
    0.8819978550635821,
    0.8712815565203409,
    0.8395496869903729,
    0.8150919196237708,
    0.923886690013884,
    0.9295316227121743,
    0.8384897631298986,
    0.9013450813141491,
    0.8755253463394386,
    0.9042685851318945,
    0.9223894637817498,
    0.8846340157560615,
    0.8880982634476917,
    0.8778729820174309,
    0.8883635105524161,
    0.908485856905158,
    0.8939507717980809,
    0.853649216660298,
    0.8760343604696982,
    0.9020217729393468,
    0.8311867525298988,
    0.8531578122551324,
    0.9233038348082596
  ];
  metrics.base_dice= [
    0.9099402214745369,
    0.7957351290684624,
    0.9049933716305789,
    0.9091837777096741,
    0.8827736188365187,
    0.929384965831435,
    0.9386499134559908,
    0.839469023177862,
    0.9193633772991969,
    0.8365105237049111,
    0.9157366762981274,
    0.9301542445561469,
    0.8470038825988977,
    0.9085040241877103,
    0.903447655863712,
    0.8801935949727757,
    0.9291088446748036,
    0.9092551809814219,
    0.9156157811132363,
    0.9286188157244689,
    0.9315432551319648,
    0.9351304419729607,
    0.930943684702285,
    0.8827943352356795,
    0.8546895640686922,
    0.9068195625759417,
    0.8526234107324061,
    0.8946162657502864,
    0.8997332806480293,
    0.9234468316140542
  ];
  metrics.apex_HD95= [
    1.875,
    5.216758060455318,
    3.125,
    3.652424728870391,
    4.24713134765625,
    3.4081794023513794,
    4.166895389556884,
    3.0662875175476074,
    4.47380781173706,
    4.3627048492431655,
    4.367272043228144,
    3.114439010620117,
    2.0963029861450195,
    5.205052280426024,
    2.8990628719329834,
    4.603955030441284,
    3.164067029953003,
    2.8125040531158447,
    3.597447872161864,
    3.5871360301971436,
    5.041761589050289,
    3.512973213195797,
    2.6516504287719727,
    3.6443450450897217,
    3.125,
    3.8108396530151367,
    3.535533905029297,
    4.001952648162842,
    3.7069191932678223,
    1.9764235019683838
  ];
  metrics.base_HD95= [
    3.653860569000244,
    8.47581787109375,
    3.7069191932678223,
    3.8017265796661377,
    4.192627429962158,
    4.002819347381591,
    2.5769410133361816,
    6.005201816558838,
    3.0543453216552696,
    8.895946598052973,
    3.7664363384246826,
    2.606711316108692,
    5.937461853027344,
    3.7536659240722656,
    3.4802961349487305,
    4.144549608230591,
    3.930593967437744,
    4.570393013954163,
    4.090748119354235,
    3.144475221633911,
    3.406506299972534,
    2.8125040531158447,
    2.5769410133361816,
    5.0,
    4.025133037567139,
    4.94070291519165,
    6.25,
    3.75,
    4.192627429962158,
    2.5769410133361816
  ];
  metrics.apex_HD95_old= [
    2.253469467163086,
    5.925406551361075,
    3.125,
    3.7069191932678223,
    4.38292121887207,
    3.856669688224791,
    4.338525485992434,
    3.0662875175476074,
    4.611162424087524,
    4.375014305114746,
    4.449007511138916,
    3.209028720855713,
    2.096311092376709,
    5.305885314941406,
    3.002723348140715,
    4.690435409545898,
    3.164067029953003,
    2.8343915939331055,
    3.6195626258850098,
    3.5871360301971436,
    5.313249039649962,
    3.5331645011901855,
    2.7950849533081055,
    3.75,
    3.125,
    3.9391826868057223,
    3.6443450450897217,
    4.169611477851857,
    3.7069191932678223,
    2.101094186305996
  ];
  metrics.base_HD95_old= [
    3.7836222767829883,
    8.513964080810547,
    3.7069191932678223,
    3.808561384677887,
    4.192627429962158,
    4.106862545013428,
    2.5769410133361816,
    6.005201816558838,
    3.0571298599243164,
    9.164196872711186,
    4.273803520202636,
    2.693030834197998,
    5.943625569343567,
    3.7666580438613892,
    3.4802961349487305,
    4.233379364013672,
    4.33561038970947,
    4.583820819854736,
    4.100646328926086,
    3.147413992881772,
    3.4277307987213135,
    2.8289197087287903,
    2.5769410133361816,
    5.0,
    4.059017658233643,
    5.0,
    6.875,
    3.75,
    4.375,
    2.7950849533081055
  ];
  metrics.wholeprostate_dice= [
    0.9365341929281362,
    0.9139072847682119,
    0.9471904806875059,
    0.9448106198400612,
    0.9275154521322974,
    0.9343107243150252,
    0.9072084942765931,
    0.9020808030005512,
    0.9060122811841261,
    0.8811241256829179,
    0.9056575482395719,
    0.931217475251201,
    0.9084535924623638,
    0.9194658323157716,
    0.9107134654881658,
    0.8398102002447103,
    0.9123223588616791,
    0.9270303809325207,
    0.927150173066413,
    0.9324442334268782,
    0.9026866973060365,
    0.9101157016460386,
    0.9240063328055995,
    0.9188699631371552,
    0.9080828873336078,
    0.9135405642010636,
    0.8931433247386867,
    0.8947381049499724,
    0.9187881001849357,
    0.9062691661555692
  ];
  metrics.apex_aRVD= [
    0.7023917650620604,
    -2.760860738936255,
    0.987056522953722,
    -0.8813123190736571,
    -0.4917888820584859,
    -6.758941853696399,
    -3.3888731996611132,
    -11.869487519455813,
    1.68639532998216,
    -13.280290751927703,
    -3.3369242491920414,
    -4.590610911643223,
    0.41551246537396835,
    -19.41896024464832,
    10.507103393843732,
    3.473395270270263,
    -3.986086302528913,
    3.730914201750468,
    -2.552227535867102,
    -9.104139715394567,
    -9.466087443946192,
    -4.398826979472137,
    3.7288135593220417,
    0.9220452640402277,
    13.632653061224499,
    -5.6219362745098085,
    -5.705652328474942,
    -13.109821620459917,
    -11.324659964518036,
    3.55266449837377
  ];
  metrics.base_aRVD= [
    3.327577045696062,
    -1.514813989752728,
    1.653465346534655,
    -3.018412315122243,
    1.9339582805506295,
    1.3910469848316787,
    2.3216601815823523,
    0.5002291125706382,
    12.298237643176545,
    9.66687468425902,
    1.3831240477066187,
    7.2769761413964185,
    -18.88768686073957,
    0.2780336369528902,
    19.690909988643668,
    17.98187773854596,
    2.943546676846087,
    -2.5477351916376345,
    5.7220981026376405,
    1.401523766204238,
    7.986276565329264,
    9.061311513195802,
    5.785701800384557,
    -3.2029950083194647,
    9.000552181115395,
    14.410160384270942,
    22.808884160127676,
    13.089244851258574,
    -4.045683313976001,
    4.78081321473951
  ];
  metrics.wholeprostate_HD95= [
    3.810849189758301,
    5.198317050933838,
    3.3657279014587402,
    3.5999999046325684,
    3.75,
    4.106862545013428,
    4.807936191558838,
    3.219862604141222,
    2.8116724491119385,
    4.401268768310536,
    3.3009448051452637,
    2.73435640335083,
    3.206519603729248,
    3.3698322772979736,
    3.481265902519226,
    5.967353820800781,
    5.967353820800781,
    4.583820819854736,
    3.5350749492645264,
    3.3286013126373275,
    5.0393805503845215,
    3.3740756511688232,
    3.125,
    4.375,
    3.125,
    3.8617515563964844,
    5.145330190658549,
    3.7198434352874736,
    3.974081134796123,
    3.7069191932678223
  ];
  metrics.apex_ASD= [
    0.7199336677340407,
    1.60403260556462,
    0.9100740239203216,
    1.1516264753037715,
    1.3533478279446447,
    1.259613613287608,
    1.70028104262645,
    1.222059192901935,
    1.4643217861081994,
    1.4672083313915838,
    1.7168029589971545,
    1.0753139389975674,
    0.8586208192895098,
    1.6843203579678254,
    1.0531581736949973,
    1.6710046908885547,
    1.1373863472627557,
    1.2314125636779374,
    1.4843169487972692,
    1.2931828150723843,
    1.7230046770476193,
    1.2793364751721221,
    1.0881545366187841,
    1.300584505095599,
    1.5021660869771785,
    1.5082155885397839,
    1.4333060109338096,
    1.80355490459485,
    1.530034314769588,
    0.874812749104622
  ];
  metrics.base_ASD= [
    1.6016788601347831,
    2.800907672012114,
    1.4267854759994063,
    1.7815948995129574,
    1.8290603406590187,
    1.5225591332844535,
    1.1007888371519032,
    1.889212791180799,
    1.0906392355723213,
    2.1951100249009396,
    1.0529614427349059,
    1.169825305976171,
    1.7697847469038348,
    1.4959859457033784,
    1.501797298469995,
    1.777540532154078,
    1.2183027730743592,
    1.6719155832367427,
    1.399822857175495,
    1.3200777540653452,
    1.2076331097760518,
    1.1253779112507274,
    1.0425193590276383,
    1.7890238906510325,
    1.7680061729860976,
    1.8780638992245249,
    1.964393782429397,
    1.3316194169889621,
    1.3801841281428195,
    1.0883919570155485
  ];
  metrics.wholeprostate_HD95_old= [
    4.059026718139648,
    5.798617219924922,
    3.5999999046325684,
    3.653850555419922,
    3.8108396530151367,
    4.38292932510376,
    5.122621536254883,
    3.5531389713287354,
    2.864362955093384,
    4.647365927696219,
    3.426168441772461,
    2.7443559169769287,
    3.206519603729248,
    3.535505533218384,
    3.5350749492645264,
    5.988029956817627,
    6.150938510894775,
    4.781774044036865,
    3.6043224334716797,
    3.462494134902954,
    5.383124780654892,
    3.3740756511688232,
    3.535533905029297,
    4.5561624526977536,
    3.3657279014587402,
    4.010611057281494,
    7.497486805915829,
    3.75,
    4.424906826019288,
    3.8617515563964844
  ];
  metrics.apex_ASD_old= [
    1.0503431076178453,
    1.8897381587186235,
    1.225981014237987,
    1.3947321848069802,
    1.6990936234049554,
    1.4537371481279924,
    1.9262677634818643,
    1.3306214741441238,
    1.6006446302124147,
    1.5565884078118772,
    1.8550832468965535,
    1.1721194626689462,
    0.9293414358730175,
    1.844344353330308,
    1.159921631165796,
    1.7727711154250076,
    1.2156080848997854,
    1.337456879354948,
    1.5996872916852238,
    1.4301080543153426,
    1.898597510377313,
    1.4173701474933247,
    1.3493116254072923,
    1.4701051350332732,
    1.7135820547739664,
    1.765002294347204,
    1.707262007483485,
    2.1009998234154668,
    1.7397586445199367,
    1.0865508667223014
  ];
  metrics.base_ASD_old= [
    1.7809565677267452,
    3.3464027991455594,
    1.617472214143981,
    1.9285853335682013,
    1.984932327080027,
    1.7440955151115565,
    1.294098096359067,
    2.079046733483024,
    1.178500319130411,
    2.3428423747845435,
    1.1688703428408849,
    1.255032815809502,
    1.875652231763771,
    1.6218617857949247,
    1.611858093393328,
    1.8199032712425927,
    1.3552256900993191,
    1.7918804615979624,
    1.5384591593765296,
    1.4059176080203852,
    1.3309852937506548,
    1.1953858684047385,
    1.1876122595108662,
    2.0288225073873263,
    1.9252827957363947,
    2.0480725124499415,
    2.28065672699286,
    1.5779305230216025,
    1.606900252938614,
    1.2995349694619829
  ];
  metrics.wholeprostate_aRVD= [
    4.194693842200992,
    2.7661619178722674,
    1.2850000950443752,
    0.07278199940787822,
    -0.0077499854687745895,
    2.1014418652213873,
    0.839532412327304,
    2.7939931859117584,
    12.949499878019033,
    3.0552353557038447,
    3.948739021989467,
    6.552589738976011,
    -1.345949116822731,
    1.073952011333823,
    17.33432210036936,
    0.6671138045847513,
    6.309863274109828,
    3.1071641832497887,
    4.144628099173553,
    1.1837650209376216,
    7.852342235759058,
    11.135001649866405,
    9.936149741974987,
    2.6859038356252585,
    10.375887753334489,
    8.389152099330177,
    11.387075718015671,
    2.748589219692543,
    2.7262207822263296,
    10.13672531659755
  ];
  metrics.wholeprostate_ASD= [
    1.329902655157687,
    1.4959947539661347,
    1.0503951903296704,
    1.1893868431156758,
    1.3509995510399087,
    1.4415884238004004,
    1.5472146602144925,
    1.2179479802822948,
    1.0858069763779106,
    1.4944714943539346,
    1.1571203980138332,
    1.0905467654847378,
    1.1626798859011735,
    1.2560345624850022,
    1.3328998960495277,
    2.2661776544615693,
    1.4917939960956574,
    1.453370362292296,
    1.259157438523907,
    1.1421658783105257,
    1.7385722773120342,
    1.2695612553947309,
    1.1710569027196958,
    1.333699329514905,
    1.2880329571580285,
    1.593557598662563,
    1.8830637735479019,
    1.38861433890651,
    1.1782677176492216,
    1.1829444634381745
  ];
  metrics.wholeprostate_ASD_old= [
    1.6467363207508097,
    1.8662593515058348,
    1.3199696200672335,
    1.456392052794705,
    1.6255712829994797,
    1.673752724442548,
    1.7991978004344962,
    1.3822164133229349,
    1.182257058020558,
    1.6411656699839392,
    1.267406773674974,
    1.1845795574957934,
    1.2491017950770276,
    1.380027718012368,
    1.4312424152957404,
    2.349730129432015,
    1.6342289587326755,
    1.6141886622520956,
    1.3873671302927502,
    1.2789448982204736,
    1.8898499166527525,
    1.3788913993867695,
    1.4013777287695495,
    1.6236014806923746,
    1.4772189242291849,
    1.8174644229107333,
    2.193721502686515,
    1.648605976248403,
    1.471280789860407,
    1.4240142063661054
  ];

%% scores
scores.apex_dice = [
    97.25922827219875,
    90.4522505555949,
    95.8184417220821,
    94.91036090127386,
    93.32876650214456,
    94.58862470272416,
    88.60618554770755,
    91.28457074677831,
    90.49308393219248,
    88.14942429693828,
    86.34301695332407,
    94.37840584363988,
    94.79533056647145,
    88.07114019943529,
    92.71352258255847,
    90.80652272564676,
    92.92944739230504,
    94.26782336813265,
    91.47927290264003,
    91.73513609638374,
    90.97991493538079,
    91.75472677735901,
    93.24092760990017,
    92.16739198892866,
    89.19079056539167,
    90.8441176070242,
    92.76350182648522,
    87.53175278190892,
    89.15449630709449,
    94.33535719132743
    ];

scores.base_dice = [
    90.15200982420588,
    77.6637421278395,
    89.6110743562373,
    90.069293090356,
    87.18135589803876,
    92.27828254725512,
    93.29139977075742,
    82.44602079454519,
    91.18242703243773,
    82.12251040968074,
    90.7858491566019,
    92.36240277731598,
    83.26995376917827,
    89.99496239484158,
    89.44205113781116,
    86.89923162499082,
    92.24808884180823,
    90.07710100113472,
    90.77262933075777,
    92.19450442992412,
    92.51429036427419,
    92.9065473871743,
    92.44872764836617,
    87.1836212255559,
    84.1103790567173,
    89.8107673901458,
    83.88444625966184,
    88.47634320356815,
    89.03588613202261,
    91.62895064653804
    ];

scores.total_score = [
    92.8381251143785,
    88.1265411661065,
    93.56787832218113,
    93.01945386555683,
    92.11110697132983,
    92.25186940965132,
    91.7961331625166,
    90.21267044770802,
    89.22124999967093,
    87.02964770572879,
    91.21120987512286,
    92.04950053069255,
    90.31970872922875,
    90.63642909037388,
    87.03560889030416,
    87.54832816181526,
    90.8771555951822,
    91.64914326786716,
    91.36748369371782,
    92.62675781811959,
    88.95126678834659,
    90.08608183677264,
    91.43103055173185,
    91.10576695349948,
    88.08762339091989,
    88.37102885867091,
    85.64596074926169,
    89.05002536715388,
    90.7190887290858,
    91.3782156066983
    ];

scores.apex_HD95= [
    95.574490350625,
    87.68703299466677,
    92.624150584375,
    91.37928486334305,
    89.97561559401825,
    91.95577022298285,
    90.16499426430923,
    92.76272800177864,
    89.44059752517781,
    89.70283071589294,
    89.69205089666569,
    92.64907738992574,
    95.05215515029418,
    87.71466181731908,
    93.15742361926175,
    89.13341471332988,
    92.5319417747593,
    93.36172595948241,
    91.50904518859953,
    91.53338393852897,
    88.10007223349851,
    91.70842834506992,
    93.74138423504014,
    91.39835511322852,
    92.624150584375,
    91.00538258312567,
    91.65517898005353,
    90.55430396758054,
    91.25066311506126,
    95.33510331775328
    ];

scores.base_HD95= [
    91.27785788954012,
    79.76734837632763,
    91.15120147988573,
    90.92488646822297,
    89.99176581323465,
    90.44485728695626,
    93.8485759639316,
    85.66496376725466,
    92.70896263094549,
    78.7644577645965,
    91.0091279146076,
    93.77751118010919,
    85.82666604825897,
    91.03961221106277,
    91.6921740985281,
    90.10653253341599,
    90.61726671965242,
    89.09000039394809,
    90.23496223752545,
    92.493813261896,
    91.86831804677566,
    93.28626268729435,
    93.8485759639316,
    88.0644842,
    90.39159220660308,
    88.2060324585248,
    85.08060525,
    91.04836315,
    89.99176581323465,
    93.8485759639316
    ];
scores.old_total_score= [
    92.20100309770844,
    87.142341269397,
    93.06729447450054,
    92.60903737482563,
    91.62391457583523,
    91.70114543309894,
    91.29870171530406,
    89.86485789734161,
    88.9989322884574,
    86.69074409525592,
    90.85699774893669,
    91.85099947729121,
    90.16431178024447,
    90.34208186585091,
    86.82085025278714,
    87.37760322944894,
    90.54186000401513,
    91.36754675343984,
    91.12239637617161,
    92.38649177214141,
    88.5572245195908,
    89.89618404838602,
    90.94285848831093,
    90.62618364550984,
    87.70441391792072,
    87.92451382123465,
    84.45111579454571,
    88.54588818508023,
    90.14974560496178,
    90.8864844956784
    ];
scores.apex_HD95_old= [
    94.68119953519884,
    86.01442993625692,
    92.624150584375,
    91.25066311506126,
    89.65511458849664,
    90.89721124283153,
    89.75990058542993,
    92.76272800177864,
    89.11640330526146,
    89.67377705416588,
    89.49913297563353,
    92.42581996305681,
    95.05213601738402,
    87.47666844813317,
    92.91275671914649,
    88.9292975121517,
    92.5319417747593,
    93.31006541383555,
    91.45684835873534,
    91.53338393852897,
    87.45928805626487,
    91.6607714171486,
    93.40283976976646,
    91.14898070125,
    92.624150584375,
    90.70245813807485,
    91.39835511322852,
    90.15858355766498,
    91.25066311506126,
    95.04084661560378
    ];
scores.base_HD95_old= [
    90.96810330684494,
    79.67628943857065,
    91.15120147988573,
    90.90857108358144,
    89.99176581323465,
    90.1964954411128,
    93.8485759639316,
    85.66496376725466,
    92.70231565084431,
    78.12411668628901,
    89.79799011170516,
    93.57145758570852,
    85.81195262156317,
    91.00859868085905,
    91.6921740985281,
    89.89448674268417,
    89.65045073819569,
    89.05794683605097,
    90.21133419017814,
    92.4867981117637,
    91.81765297874303,
    93.24707682390722,
    93.8485759639316,
    88.0644842,
    90.31070612153468,
    88.0644842,
    83.588665775,
    91.04836315,
    89.556423675,
    93.32784387548976
    ];
scores.wholeprostate_dice= [
    90.46420875460706,
    87.06449664311259,
    92.06532501419682,
    91.70774890660209,
    89.10913531296256,
    90.13013071265388,
    86.05799769921109,
    85.28755774285679,
    85.87826566911465,
    82.13879922976804,
    85.82496674380752,
    89.66536742145101,
    86.24507475597227,
    87.8996731191115,
    86.58462259175948,
    75.9313469480453,
    86.82636018354077,
    89.0362529544378,
    89.05425182399512,
    89.84968887616532,
    85.37859387532725,
    86.49480806829345,
    88.58188716260395,
    87.81014327044235,
    86.18937599646355,
    87.00939656735957,
    83.94469406575507,
    84.18431114296064,
    87.79784329254983,
    85.91686285360419
    ];
scores.averaged_total_score= 90.3440696883131,
scores.apex_aRVD= [
    99.46517526687255,
    97.8977877000406,
    99.24842193811342,
    99.32893913440334,
    99.62553539109511,
    94.85351415985383,
    97.41959787291725,
    90.96217266386695,
    98.71592182999838,
    89.88793959361524,
    97.45915355245803,
    96.50455432732096,
    99.68361482229916,
    85.21375000810397,
    91.99953779632004,
    97.35523992325803,
    96.96485971360346,
    97.15915634048424,
    98.0566480436597,
    93.06780156625162,
    92.79220238220992,
    96.65058506891496,
    97.16075584033898,
    99.29792369899414,
    89.61963907044897,
    95.7192684805913,
    95.65552425913614,
    90.01774052847625,
    91.3770227036369,
    97.29488166469854
    ];
scores.base_aRVD= [
    96.01171982719183,
    98.18441390902206,
    98.0182327959802,
    96.38227039541202,
    97.68204691899332,
    98.3327553253126,
    97.2173653252659,
    99.40044848725371,
    85.25990031809943,
    88.41373043905381,
    98.34225139185362,
    91.27815246223442,
    77.36209079987215,
    99.66676172289769,
    76.3993846532168,
    78.44775178165654,
    96.47200089200491,
    96.94640225880975,
    93.1417574721131,
    98.32019833899817,
    90.42801773102069,
    89.13953048977181,
    93.06552501733961,
    96.16103810374376,
    89.21235381921592,
    82.72864725343972,
    72.66232480555925,
    84.31183560878719,
    95.15103081761517,
    94.26993806832911
    ];
scores.old_averaged_total_score= 89.92379080010905,
scores.wholeprostate_HD95= [
    89.85805010461975,
    86.16553202562824,
    91.04266738504998,
    90.41919088420477,
    90.01999024,
    89.07025912474334,
    87.20446663540949,
    91.43086394261643,
    92.51719507091727,
    88.28674526290071,
    91.21507696731439,
    92.72295904193072,
    91.46637414910687,
    91.03174426213418,
    90.73518195085411,
    84.11886683387598,
    84.11886683387598,
    87.80091292793561,
    90.59197800106894,
    91.1414737100615,
    86.58851544608221,
    91.0204512187618,
    91.6833252,
    88.35665528,
    91.6833252,
    89.7225818070581,
    86.30654786101468,
    90.10024698937576,
    89.42363506338742,
    90.13464273910822
    ];
scores.apex_ASD= [
    95.76165271161942,
    90.55684218010437,
    94.64227060855661,
    93.22021851791743,
    92.03265751571445,
    92.5844835690376,
    89.99021455798491,
    92.80557154275232,
    91.37933875074579,
    91.36234526659172,
    89.89294779218824,
    93.66948078445493,
    94.94518261295264,
    90.08417727646216,
    93.79991478414229,
    90.16256841718493,
    93.30405208588877,
    92.7505069785537,
    91.26162451211228,
    92.38685711852665,
    89.85643743566439,
    92.46837240222631,
    93.59388644215898,
    92.34328236401063,
    91.15654421125225,
    91.12092997386755,
    91.56193283197712,
    89.38222730519809,
    90.99248016898056,
    94.84985852282982
    ];
scores.base_ASD= [
    89.11499986517556,
    80.96504789673189,
    90.30357427748521,
    87.89229151730882,
    87.56971665780739,
    89.65269706457585,
    92.51904552214457,
    87.16092095703596,
    92.58802215492153,
    85.08204515167884,
    92.84408021395133,
    92.04987408512083,
    87.97255324513843,
    89.83328829144537,
    89.79379437214446,
    87.91984497408873,
    91.72042150318732,
    88.63767150712374,
    90.48681207679586,
    91.02875932958817,
    91.79293247235304,
    92.35193831885763,
    92.91504455355177,
    87.84180413712778,
    87.9846404230467,
    87.23668876134909,
    86.64999138167254,
    90.95032225608576,
    90.62027676406186,
    92.60329464680633
    ];
scores.wholeprostate_HD95_old= [
    89.1975663298308,
    84.5679316135054,
    90.41919088420477,
    90.2758762120874,
    89.85807548509705,
    88.33555268215314,
    86.36698321903735,
    90.54390357000077,
    92.37696793386283,
    87.63179804888007,
    90.88181480312183,
    92.69634697697506,
    91.46637414910687,
    90.59083207251908,
    90.59197800106894,
    84.06384069007672,
    83.63028630082941,
    87.27409289877264,
    90.40768718287084,
    90.78513993059354,
    85.67369657327102,
    91.0204512187618,
    90.59075656559912,
    87.87452113438157,
    91.04266738504998,
    89.3264166679378,
    80.04666893373034,
    90.01999024,
    88.22383645046317,
    89.7225818070581
    ];
scores.apex_ASD_old= [
    93.81648746050047,
    88.87485478215858,
    92.78248324785775,
    91.78902218575284,
    89.99720505622544,
    91.4416519522149,
    88.65980003721076,
    92.16645064739058,
    90.57678765118132,
    90.83615261647782,
    89.07887295512782,
    93.09957351779767,
    94.52884073735633,
    89.142094280184,
    93.17138380865157,
    89.56345565331068,
    92.84355009179562,
    92.12620968848186,
    90.58242363312331,
    91.58075963695889,
    88.82269857560472,
    91.65574942457178,
    92.05641918827713,
    91.34529139008895,
    89.9119096928359,
    89.60919175821138,
    89.94911666966803,
    87.63112866705013,
    89.75780455351372,
    93.60332746466123
    ];
scores.base_ASD_old= [
    87.89662961638219,
    77.2578662136984,
    89.00766832400446,
    86.89334539000924,
    86.51041155274703,
    88.14713711365434,
    91.20531693091141,
    85.8708105990956,
    91.9909187466296,
    84.07805696876329,
    92.05636400898452,
    91.47080434829118,
    87.2530784392607,
    88.97783682082265,
    89.04582185568223,
    87.63194804782773,
    90.78989416254937,
    87.82239089773479,
    89.54464058055545,
    90.44539218581798,
    90.95463175389226,
    91.87616465284567,
    91.92899405327289,
    86.21213414492621,
    86.91578941773491,
    86.0813112234797,
    84.5006702662502,
    89.2763934248415,
    89.07951531031986,
    91.16836797320757
    ];
scores.wholeprostate_aRVD= [
    90.10878551299113,
    93.4773068393678,
    96.9699310524075,
    99.82837785211068,
    99.98172530071882,
    95.04473675485735,
    98.02035727242297,
    93.41167987063541,
    69.4646890544523,
    92.79566296173289,
    90.68875439089841,
    84.54879593320278,
    96.82621142235537,
    97.46758879373098,
    59.12514611753256,
    98.42692554531466,
    85.12115225191926,
    92.67321322150434,
    90.22684204378099,
    97.20864640787018,
    81.48394037774688,
    73.7433305563403,
    76.57025948255051,
    93.66655781588355,
    75.53334400025983,
    80.21812654268093,
    73.14893230739229,
    93.51874379122884,
    93.57148924084704,
    76.09729623324556
    ];
scores.wholeprostate_ASD= [
    89.00932299289501,
    87.63669274484172,
    91.31924865180366,
    90.17058385552687,
    88.83497251123022,
    88.08632144486307,
    87.21339751813721,
    89.93454685512197,
    91.02659602704838,
    87.64928137629586,
    90.43724252780375,
    90.98742512160436,
    90.39129740884508,
    89.61978898794193,
    88.98455297952076,
    81.27169192097547,
    87.67140894964093,
    87.98895230285873,
    89.59398069156495,
    90.56083074324042,
    85.63196615982552,
    89.50800072120785,
    90.32206746500039,
    88.97794624407847,
    89.35534555726437,
    86.83040687888438,
    84.43784916243261,
    88.52411368067652,
    90.26247533053771,
    90.22382543220765
    ];
scores.wholeprostate_ASD_old= [
    86.3909234656768,
    84.57672547359657,
    89.09141229466158,
    87.9639802312574,
    86.56583709026873,
    86.16765256256379,
    85.13094035884556,
    88.57698787664256,
    90.22950633741425,
    86.43696083770595,
    89.52580594372374,
    90.2103125705002,
    89.67708326211374,
    88.5950758495721,
    88.17182367117002,
    80.58119155842411,
    86.49428770487064,
    86.65990616189866,
    88.53442095164944,
    89.43045174644055,
    84.38176663135401,
    88.60446669554317,
    88.41863355778452,
    86.58211607192297,
    87.79186130502084,
    84.97998002587049,
    81.87048925268165,
    86.37547212447606,
    87.84093566141748,
    88.23155955437724
    ];

%% analyze

% factors
% wholeprostate
factors.wholeprostate_ASD = [ones(30,1) metrics.wholeprostate_ASD]\scores.wholeprostate_ASD;
factors.wholeprostate_DSC = [ones(30,1) metrics.wholeprostate_dice]\scores.wholeprostate_dice;
factors.wholeprostate_HD95 = [ones(30,1) metrics.wholeprostate_HD95]\scores.wholeprostate_HD95;
factors.wholeprostate_aRVD = [ones(30,1) abs(metrics.wholeprostate_aRVD)]\scores.wholeprostate_aRVD;

% apex
factors.apex_ASD = [ones(30,1) metrics.apex_ASD]\scores.apex_ASD;
factors.apex_DSC = [ones(30,1) metrics.apex_dice]\scores.apex_dice;
factors.apex_HD95 = [ones(30,1) metrics.apex_HD95]\scores.apex_HD95;
factors.apex_aRVD = [ones(30,1) abs(metrics.apex_aRVD)]\scores.apex_aRVD;

% base
factors.base_ASD = [ones(30,1) metrics.base_ASD]\scores.base_ASD;
factors.base_DSC = [ones(30,1) metrics.base_dice]\scores.base_dice;
factors.base_HD95 = [ones(30,1) metrics.base_HD95]\scores.base_HD95;
factors.base_aRVD = [ones(30,1) abs(metrics.base_aRVD)]\scores.base_aRVD;

% save factors
save('factors','factors');